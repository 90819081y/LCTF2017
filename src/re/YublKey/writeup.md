# YublKey

本题是临时起意想到的。GH60是一款开源键盘，大多数情况下其使用的固件是`tmk_keyboard`。本题设计是，在烧入此固件后按下特定按钮，即通过`print`函数输出flag，这个输出操作是通过使用固件自带的钩子点`hook_matrix_change`实现的，所以如果能找到源码并阅读一下，或者是自行编译后做bindiff，就可以发现这个hook点被改动过，直接分析相关代码即可。

这个题首要难题就是怎么知道这是个GH60的固件，实际通过字符串就能看到GH60（从一个老司机那里学到的这一招，`strings -e l ./YublKey-stripped-elf`），搜一下就有一些思路了，当然还是有点小脑洞。另外一点就是IDA对部分MCU的支持不太好，不过对GH60使用的MCU来说应该还是没什么大问题的。放出elf文件之后，加载和函数识别实际就没有什么问题了，题目难度下降了一档，但是仍然没有人做，可能是大家已经对我失去信心了吧233……

同上题一样，这个题的设计和实现也有一些差距……原意是在固件中植入一个键盘记录器，输入flag字符串后将内存中的记录信息输出，选手需要逆向程序逻辑来得到flag。但由于编码时间不够，就选择了现在这种比较挫的设计思路。

题目源代码同样也在github上开源了，地址为https://github.com/SilverBut/LCTF2017_YublKey 公开。我是clone后直接修改的，所以可以看一下最近的几次提交记录。